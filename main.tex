 \documentclass{beamer}
%\documentclass[handout]{beamer}
\usetheme{metropolis}

%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen}

% Packages
\usepackage[utf8]{inputenc}

\usepackage{animate}

\usepackage{appendixnumberbeamer}
\usepackage{xcolor}
\usepackage{multirow}
% Maths
\usepackage{amsthm}
\usepackage{tikz}
\usetikzlibrary{cd}

% References
\usepackage{biblatex}
\addbibresource{./references.bib}

% Package Settings
% AMSTHM
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{mylemma}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{rem}[thm]{Remark}
\newtheorem{alg}[thm]{Algorithm}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}

\newcommand{\todo}[1]{{\color{red}*** #1 ***}}

\input{./abbreviations.tex}

\title{Normalizers of simple diagonal groups in polynomial time}
\subtitle{Groups and Combinatorics Seminar}
\date{July 30th, 2021}
\author{Sergio Siccha}
\institute{TU Kaiserslautern}

\begin{document}

\maketitle
\note{
VERSION WITH NOTES!
}

\section{Introduction}
\begin{frame}{TODO}
!! Theory vs Algorithmic !!

Everything has to be explicit and constructive.

O'Nan-Scott as Example:
- Theorem: there exists a p.iso
- Algorithmic: Given a group $G .. $, what is this p.iso? Construct it!

Connection: Cartesian Decomposition + Product Decomposition

Approaches:
- backtrack
- O'Nan-Scott

For SD type: say
$W = \sset{(a_1, \ldots, a_k) \cdot \pi }{ \ldots a_i \equiv a_j mod Inn }$
\end{frame}

\begin{frame}{Representation}

Groups are given by their generating sets.

Compute a group: compute a generating set.

Permutation groups are given on points $\set{1, \ldots, n}$.

\end{frame}

\begin{frame}{Normalizers}
Let $G, M \leq K$ be groups.
The \emph{normalizer of $G$ in $M$} is
the group
\[
N_M(G) = \set{ m \in M ~|~ G ^ m = G }.
\]

\pause
\emph{Normalizer problem}: Given $G, M \leq S_n$, compute $N_M(G)$.

\pause
In practice partition backtrack.

Best known theoretical algorithm by D. Wiebking for
$N_{S_n}(G)$ in
time $2 ^ {O(n)}$.
\end{frame}

\note{
theoretical,
canonical labelling
}


\begin{frame}{Motivation}
Normalizers remain hard in practice.

Permutation morphisms are very nice tools.
\end{frame}

\begin{frame}{Primitive Groups}
A transitive group $G \leq \Sym \Omega$ is
\emph{imprimitive}, if there exists a non-trivial $G$-invariant partition of
$\Omega$,
otherwise it is \emph{primitive}.

\begin{columns}
\begin{column}{0.5\textwidth}
$D_8 := \gen{ (1,2,3,4),\, (1,4)(2,3) }$
\\[1em]

$\set{ \set{1,3}, \set{2,4} }$ is $D_8$-invariant.
\end{column}
\begin{column}{0.3\textwidth}
{
\only<1->{
\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{./pictures/square.png}
\caption{A square}
\end{figure}
}
}
\end{column}
\end{columns}
\end{frame}

\begin{frame}%{Resultat}
\begin{block}{Theorem (S. 2020)}
Let $G = \gen X \leq \Sym \Omega$ be a primitive group
with non-regular socle.
We can compute (a generating set of) $N_{\Sym \Omega}(G)$
in time $O(\abs X \abs \Omega ^ c)$.
\end{block}
\vspace{1em}
\pause
Note: For $M \leq \sym \Omega$ we have
$N_{M}(G) = M \cap N_{\sym \Omega}(G)$.

\vspace{1em}
\pause
Note: Most parts in nearly-linear time.

\end{frame}

%\begin{frame}{Implementation}
%A partial implementation is available at the github repository
%\begin{center}
%\href{https://github.com/ssiccha/NormalizersOfPrimitiveGroups}
%{\textcolor{blue}{ssiccha/NormalizersOfPrimitiveGroups}}
%\end{center}
%\vspace{1\baselineskip}
%
%$N_{\Sym \Omega}(G)$ for $G$ primitive with $\abs \Omega = 5 ^ 7 = 78125$ in
%$\approx 67 s$.
%\end{frame}


\section{Strategy}
\begin{frame}{Standing on the shoulders of giants}
Ingredients:
\begin{itemize}
\item O'Nan-Scott Theorem
\item Classification of finite simple groups (CFSG)
\end{itemize}

\pause
Problem:
\begin{itemize}
\item Use O'Nan-Scott algorithmically
\end{itemize}

\end{frame}

\note{Reconstruct the component-wise action}


\begin{frame}{Classification of primitive groups}
Let $G$ be a group. The \emph{socle} of $G$, denoted $\soc G$,
is the group generated by all minimal normal subgroups of $G$.

The socle of a primitive group is a direct power of a simple group.
\pause
\begin{block}{O'Nan-Scott Theorem}
    Let $G \leq S_n$ be primitive.
    Then $\soc G \leq G \leq N_{S_n}(\soc G)$
    and we know all possible permutational isomorphism types of
    \vspace{-0.5em}
    \begin{itemize}
        \item
        $\soc G$ and
        \item
        $N_{S_n}(\soc G)$.
    \end{itemize}
\end{block}
\end{frame}

\note{
Typ PA: einfachster nicht-trivialer Fall.
}

\begin{frame}{Main steps}
Let $G \leq S_n$ be primitive.
Compute $N_{S_n}(G)$.

Compute:
\begin{itemize}
\item Step 1: $M := N_{S_n}(\soc G)$.
Then we have $N_{S_n}(G) = N_M(G)$.

\item Step 2: Grouphomomorphism
$
    \rho : M \to S_k
$
with $k \leq c \cdot \log n$.
Use Wiebking's $2 ^ {O(n)}$ algorithm.
\end{itemize}
\vspace{1em}

\pause
Today: focus on step 1 for primitive groups of type SD.
\end{frame}

\section{Permutation morphisms}
\begin{frame}{Language}
``Language serves not only to express thoughts, but to make possible thoughts
which could not exist without it.''

\hfill --
Bertrand Russell
% Human Knowledge: Its Scope and Limits
\hspace{2em}

\vspace{2em}

``[...] many properties of mathematical systems can be unified and simplified
by a presentation with diagrams of arrows.''

\hfill --
Saunders Mac Lane
% Categories for the working  mathematician
\hspace{2em}
\end{frame}
\note{always superior? No, I tried to formulate the concept of "a group leaves
a cartesian decomposition invariant" with diagrams of arrows.
That did not work out.}

\begin{frame}{Permutation isomorphism (1)}
Let $G \leq \sym \Omega$ and $H \leq \sym \Delta$.
We call $(f, \varphi)$ with
isomorphisms
$f \from \Omega \iso \Delta$
and
$\varphi \from G \iso H$
a \emph{permutation isomorphism}
from $G$ to $H$
if
$\forall g \in G, ~ \forall \omega \in \Omega :$
\[
    f(\omega ^ g) = f(\omega) ^ {\varphi(g)}.
\]
\end{frame}

\begin{frame}{Permutation isomorphism (2)}
Let
$f \times \varphi \from (\omega, g) \mapsto (f(\omega), \phi(g))$.

\pause
Let $\rho \from \Omega \times G \to \Omega$ and
$\tau \from \Delta \times H \to \Delta$ be \textbf{natural} actions,
and
$f, \phi$ be as before.
\pause
Then $(f, \phi)$ is a \emph{permutation isomorphism}
if and only if:
\vspace{1em}
\[
\begin{tikzcd}[ampersand replacement=\&]
    \Omega \times G
        \ar[r, "\rho"]
        \ar[d, "f \times \varphi"]
    \&
    \Omega
        \ar[d, "f"]
    %
    \\
    %
    \Delta \times H
        \ar[r, "\tau"]
    \&
    \Delta
\end{tikzcd}
\raisebox{-2em}{.}
\]
\end{frame}

\begin{frame}{Action morphism}
Let $\rho \from \Omega \times G \to \Omega$ and
$\tau \from \Delta \times H \to \Delta$ be actions.
We call $F = (f, \phi)$ with
$f \from \Omega \to \Delta,~ \phi \from G \to H$
an \emph{action morphism}
if:
\vspace{1em}
\[
\begin{tikzcd}[ampersand replacement=\&]
    \Omega \times G
        \ar[r, "\rho"]
        \ar[d, "f \times \varphi"]
    \&
    \Omega
        \ar[d, "f"]
    %
    \\
    %
    \Delta \times H
        \ar[r, "\tau"]
    \&
    \Delta
\end{tikzcd}
\raisebox{-2em}{.}
\]

\pause
If $\rho$ and $\tau$ are \textbf{natural} actions, we also call $F$ a
\emph{permutation morphism} from $G$ to $H$.
\end{frame}

\begin{frame}{Composition}
Componentwise:
\[
\begin{tikzcd}[ampersand replacement=\&]
    \Omega \times G
        \ar[r, "\rho"]
        \ar[d, "f \times \varphi"]
    \&
    \Omega
        \ar[d, "f"]
    %
    \\
    %
    \Delta \times H
        \ar[r, "\tau"]
        \ar[d, "g \times \psi"]
    \&
    \Delta
        \ar[d, "g"]
    %
    \\
    %
    \Gamma \times K
        \ar[r, "\nu"]
    \&
    \Gamma
\end{tikzcd}
\raisebox{-3em}{.}
\]
\end{frame}

\begin{frame}{Categories}
\begin{block}{Theorem (S.)}
\begin{itemize}
\item Right-actions together with action morphisms form a category.
\item
Permutation groups together with permutation morphisms form a category.
That category admits finite products.
\end{itemize}
\end{block}
\end{frame}

\note{admits = ``existence'', finite products used in PA case}

\begin{frame}{Permutation morphisms}
\begin{block}{Lemma (S.)}
Let $G \leq \sym \Omega$ and $f : \Omega \onto \Delta$.
There exist a (unique) group $H \leq \Sym \Delta$ and a (unique)
group epim. $\phi : G \to H$ such that
$(f, \phi)$ is a permutation epimorphism
if and only if:
\[
    \set{ f ^ {-1}(\set{\delta}) ~|~ \delta \in \Delta }
\]
is $G$-invariant.
\end{block}

%We call such an $f$ \emph{compatible} with $G$.

\pause
If $G$ transitive: think the action induced on the above block system.
\end{frame}

\note{$\onto$ means surjective}

%\begin{frame}{Primitive groups and permutation morphisms}
%Note:
%a group $G$ is simple iff. all group homomorphisms
%$\phi : G \to H$ are trivial or injective.
%
%\begin{block}{Lemma (S.)}
%A permutation group $G$ is primitive iff. all permutation morphisms
%$F : G \to H$ are trivial or injective. we have $\ker \phi = \set{1_G}$ or $\ker \phi = G$.
%\end{block}
%a group admits only trivial group homomorphisms and group isomorphisms
%\end{frame}

\begin{frame}{Push-forward action}
\begin{block}{Definition}
Let $\rho : \Omega \times G \to \Omega$ be an action.
Let $f : \Omega \onto \Delta$ be surjective such that there exists
an action $\tau : \Delta \times G \to \Delta$ with
$(f, \id_G)$ being a morphism from $\rho$ to $\tau$.

We call $\tau$ the push-forward of $\rho$ by $f$.
\end{block}
\end{frame}

\begin{frame}{Permutation morphisms and products}
\todo{push-forward example?}

\begin{block}{Example}
$\Omega := \set{1, \ldots, 4}$ und
$V := \langle a := (1,2)(3,4),~$%
$b := (1,3)(2,4) \rangle$.

\begin{figure}[H]
\centering
\begin{tikzpicture}
    % nodes
    \foreach \x in {1, ..., 2}
        \foreach \y in {1, ..., 2}
            \draw [fill] (\x, \y) circle [radius=0.050];
    \node [above left] at (1, 2) {{$1$}};
    \node [above left] at (2, 2) {{$2$}};
    \node [above left] at (1, 1) {{$3$}};
    \node [above left] at (2, 1) {{$4$}};
\end{tikzpicture}
\end{figure}

\only<1>{\vspace{9.25em}}
\only<2>{
\begin{align*}
p_1 &: \Omega \to \set{1,3},~~
1,2 \mapsto 1, ~~ 3,4 \mapsto 3,
\\
\pi_1 &: G \to \gen{(1,3)},~~
\id_\Omega, a \mapsto \id_{\set{1,3}},
~~b, ab \mapsto (1,3).
\end{align*}

Analoguously $P_2$.
Then $P_1 \times P_2 : V \iso \gen{(1,3)} \times \gen{(1,2)}$
}
\only<3>{
For
$p_1' : \omega \mapsto \omega ^ {\gen{a}}$
we have
\begin{align*}
1 ^ {\gen a} = 2 ^ {\gen a} = \set{ 1,2 }
\\
3 ^ {\gen a} = 4 ^ {\gen a} = \set{ 3,4 }
\end{align*}
\vspace{0.75em}
}
\end{block}
\end{frame}

%\begin{frame}{Permutation morphisms and products}
%$\Delta = \set{1, \ldots, 5}$, $\Omega = \Delta ^ 2$,
%$H = (A_5) ^ 2 \leq \Sym(\Delta ^ 2)$,
%$N_1 := \mathbf 1 \times A_5 \unlhd H$.
%\end{frame}

\section{Primitive groups of type SD}
\begin{frame}{TODO}

\end{frame}

%\begin{frame}{AS Type}
%Let $G \leq \sym \Omega$ be primitive.
%We say $G$ is of \emph{type AS}, if
%there exist a non-regular non-abelian simple group
%$T \leq \sym \Omega$ with $\soc G = T$.
%
%Use constructive recognition to compute $N_{\sym \Delta}(T)$.
%\end{frame}

\begin{frame}{PA Type}
Let $G \leq \sym \Omega$ be primitive.
We say $G$ is of \emph{type PA}, if
there exist a non-abelian simple group
$T \leq \sym \Delta$
and a permutation iso.
$(f : \Omega \to \Delta ^ \ell,~ \phi : G \to H)$
with
\[
\phi (\soc G) = T ^ \ell \leq \sym(\Delta ^ \ell).
\]

\pause
\begin{block}{Corollary}
$G \leq \sym(\Delta ^ \ell)$ primitive s.t.
$\soc G = T ^ \ell$.
Let $M := N_{\sym (\Delta ^ \ell)}(T ^ \ell)$.
Then
\[
    M = N_{\sym \Delta}(T) \wr S_\ell
\]
and thus $M / (\soc G) \into \Out(T) \wr S_\ell$.
\end{block}
\end{frame}

\begin{frame}{PA Type}
\begin{block}{Step 1}
Let $G \leq \sym(\Delta ^ \ell)$ primitive with
$\soc G = T ^ \ell$.
Then $M = N_{\Sym \Delta}(T) \wr S_\ell$ can be computed in polynomial
time.
\end{block}
\vspace{1em}

\pause
\begin{block}{Step 2}
\vspace{-1em}
\[
    M \to \Sym( \Delta \times \set{1, \ldots, \ell} ).
\]
\pause
Theoretical version: Let $d := \abs \Delta$.
Then $\abs{\Out T} \leq 3 \log d$ by
\cite{guralnick-maroti-pyber:normalizers-primitive-groups}
and $\ell = \log_d(n)$.
\[
    M \to \Out T \wr S_\ell \to S_{(3 \log n)}.
\]
\end{block}
\end{frame}

\begin{frame}
How to find $T ^ \ell$ if $G \leq \Sym \Omega$ is arbitrary?
Find $\ell$ \emph{projections} $\pi_i : \soc G \onto T$
such that
\[
\prod \pi_i : \soc G \iso T ^ \ell
\]
yields a permutation isomorphism.
\end{frame}

\begin{frame}{Triangles}
\todo{make arrows surjective arrows}
\begin{block}{Lemma}
Faithful action of $G$ on $\Omega$.
$H \leq \sym \Delta$, $K \leq \sym \Gamma$.
\[
\begin{tikzcd}[ampersand replacement=\&]
    \&
    \Omega
        % the apostrophe ' after "f" causes the label to be placed on the
        % opposite side
        \ar[ld, "f"']
        \ar[rd, "k"]
    \&
    %
    \&
    \raisebox{-2em}{$\Rightarrow$}
    %
    \&
    \&
    G
        \ar[ld, "\phi"']
        \ar[rd, "\kappa"]
    \&
    \\
    \Delta
        \ar[rr, "g"]
    \&
    \&
    \Gamma
    \&
    \&
    H
        \ar[rr, dashrightarrow, "\psi"]
    \&
    \&
    K
\end{tikzcd}
\]
\end{block}
\end{frame}

\begin{frame}{TODO}
Prerequisuites for Correctness:

Instead of giving names to everything, construct everything step-by-step?
\begin{itemize}
\item push-forward actions
\item multiplication compatible maps. Here we can just say:
Wlog $1 \in \Omega$.
$i : T \iso \Omega, t \mapsto 1 ^ t$.
\end{itemize}
\end{frame}

\begin{frame}{Correctness}
Construct isomorphism between socle of weak canonical form SD group and the
standard diagonal thingy:

8.2.1 - 8.2.8
\end{frame}

\begin{frame}[standout]
Thanks!
\end{frame}

\printbibliography
\appendix


\begin{frame}{Wreath products}
\begin{defn}
    Let $H$ be a group and let $K \leq S_\ell$.
    $K$ acts on $H ^ \ell$ by permuting components.
    The group
    $H \wr K := H ^ \ell \rtimes K$
    is the \emph{wreath product of $H$ with $K$}.
\end{defn}

\pause
If $H \leq \Sym \Delta$, then $H \wr K$ acts faithfully on
\begin{itemize}
\item $\Delta \times \set{1, \ldots, \ell}$ via the \emph{imprimitive action}
\item $\Delta ^ \ell$ via the \emph{product action}
\end{itemize}

$i$-th copy of $H$ acts on $i$-th copy of $\Delta$, $K$ permutes the copies.
\end{frame}

\note{
    Make sure to explain intuition behind wreath products
}

\end{document}
